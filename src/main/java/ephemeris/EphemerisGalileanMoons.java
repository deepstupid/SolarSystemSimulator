/*
 * Java version by Marco Brassé, from original Fortran source:
 * ftp://ftp.imcce.fr/pub/ephem/satel/galilean/L1/L1.1/
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is furnished
 * to do so, subject to the following conditions:
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR I
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 * IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
package ephemeris;

import util.Vector3D;

import java.util.*;

/**
 * Main class for feasibility study
 * @author Marco Brassé
 */

public class EphemerisGalileanMoons implements IEphemeris {
    private final double[] coefcheb=
            {         8.26698820334074E-005,-5.46986318473484E-006, 5.94965634346142E-005
                    ,-1.10076009434021E-005,-5.75048718532862E-006, 5.74994024502453E-006
                    , 1.78506935927118E-006,-2.40677412003469E-006,-1.38513209122323E-006
                    ,-1.33581115495368E-007,-7.58579668623469E-009,-1.73800453537518E-009
                    ,-3.02381800276162E-009,-7.21047445746571E-009,-3.92259073275152E-010
                    ,-4.16879673796892E-009,-3.29083173926104E-009, 2.88537255009037E-009
                    ,-4.47550080805276E-008,-5.78177122641661E-010,-5.35142525086474E-009
                    , 1.02942385189608E-010,-8.49040607452073E-009,-2.52840670456370E-009
                    ,-6.13405545173217E-009,-3.43800069555589E-009,-3.59984191898440E-009
                    ,-2.91234929817703E-007,-1.62905002759586E-007,-3.68431020234090E-009
                    , 7.77164290527916E-010, 1.59932283427177E-009,-2.28491296590504E-009
                    , 7.03033944342130E-010,-2.89289190860300E-011, 4.86451562749639E-010
                    ,-3.17117027043262E-007,-1.26321744097649E-007, 6.51758518535435E-009
                    , 2.62070675646012E-009, 2.59238370832140E-009,-7.26318061740534E-010
                    ,-1.18191642174809E-009, 5.90816038543625E-010, 1.23053999757825E-009
                    ,-2.34691437046728E-004, 2.59036121717763E-005,-1.73835841495123E-004
                    , 3.80673357683932E-005,-1.03485888270120E-007, 1.17376776995138E-005
                    , 3.19509608989603E-006,-4.83167496026174E-006, 4.47094431509368E-007
                    ,-1.00355398526925E-006,-5.80438343691240E-008, 3.80875695145265E-008
                    ,-2.10657418625019E-007, 3.12238251072476E-007,-1.72444072203130E-007
                    , 2.35985832098386E-007, 6.13727340553035E-008,-1.58131098756712E-007
                    ,-2.61024960215820E-007,-1.82656275716032E-007, 2.78016374834476E-008
                    ,-1.58858363289506E-007, 2.31850746815330E-008,-1.10691155968765E-007
                    ,-3.69048459423356E-008, 6.78631069587260E-009, 1.90777145516695E-008
                    ,-2.74704767394256E-006,-1.54365304913777E-006,-3.49546762061882E-008
                    , 2.86789414864130E-009, 1.75452766852069E-008,-1.97744662243578E-008
                    , 3.43169676541053E-009,-1.30924950693160E-010, 1.35338072425105E-008
                    ,-2.98415696654187E-006,-1.19708851225481E-006, 5.67146658521585E-008
                    , 2.68814727457189E-008, 2.61897719058852E-008,-5.11649608698392E-009
                    ,-1.27841777400320E-008, 1.19534263567129E-008, 1.15749543781328E-008
                    ,-4.02499890223698E-004, 4.22870514937427E-005,-2.88258753042082E-004
                    , 6.23338370193608E-005, 1.78692873660163E-006, 1.44147643545141E-005
                    , 6.58944353306297E-006,-6.19139500170464E-006, 7.82954615405540E-007
                    ,-1.11797459279082E-007,-2.78967292638245E-007,-7.04645336679784E-008
                    ,-2.38693040681653E-007, 1.22869992713930E-008,-1.53370399783488E-007
                    , 4.47318789843126E-008,-1.65802124252890E-008,-8.28946056921499E-008
                    ,-1.07044201697345E-007,-2.23668695371038E-007,-2.18527598721759E-007
                    ,-2.00040954734845E-007,-3.19586844323525E-007,-2.22086683443490E-007
                    ,-2.98609138042077E-007,-1.29217448782639E-007,-1.50654590880644E-007
                    ,-1.41968295962213E-005,-7.93995493982020E-006,-2.08882224662785E-007
                    , 2.09762683478441E-008, 8.35070484335148E-008,-1.07729670354460E-007
                    , 3.06301230195125E-008, 1.12449433356374E-008, 7.08786417409988E-009
                    ,-1.53976109321613E-005,-6.12022141299496E-006, 3.15217558237908E-007
                    , 1.48179418616661E-007, 1.41150094231365E-007,-2.24063936978287E-008
                    ,-3.33311708439601E-008, 1.07863442857316E-008, 6.62499119729457E-008
                    , 3.06204347064615E-004,-1.68321429486551E-004, 2.02182016979082E-004
                    ,-1.37641833741129E-004,-5.30404402536766E-005,-1.10474926063654E-005
                    ,-1.05634674903822E-005, 3.11526543050599E-005, 4.66495863544146E-006
                    ,-1.81310025984216E-007,-1.26014618556329E-006,-3.82306332383069E-007
                    ,-6.67102945644653E-007,-5.05214970641581E-008, 1.53918794369926E-007
                    , 9.28279781805284E-008, 3.66048038576706E-007, 5.68038769950531E-008
                    ,-1.40782617429892E-006,-1.35394137498700E-006,-3.20084097458594E-007
                    ,-6.20618627039507E-007,-6.11742588608485E-007,-2.76537195728238E-007
                    ,-1.33810977431205E-007, 2.89677483700145E-007, 4.70713328715423E-008
                    ,-6.40936655172450E-005,-3.57948862513955E-005,-8.87261624128964E-007
                    , 1.64506004407617E-007, 4.77415826267116E-007,-3.59030239515192E-007
                    , 1.17406290303369E-007, 8.95051737231057E-008, 9.71875658565188E-009
                    ,-6.96069435911693E-005,-2.76636397672750E-005, 1.38328020437413E-006
                    , 6.51631405812798E-007, 6.20307849865976E-007,-2.66081185506962E-007
                    ,-2.09003718083271E-007,-1.46372661194868E-007,-1.22390974721364E-007};

    private final double[][][] AF=
            {
                    {
                            {
                                    0.0000000006827622,462.51460581,-2.709383024651,
                                    0.0000000006827622,-462.51460581,2.709383056866,
                                    0.0000000003280812,-482.05605144,1.755848247185,
                                    0.0000000003280812,482.05605145,-1.755848223779,
                                    0.0000000001706288,-403.51538063,-2.610358561262,
                                    0.0000000001706288,403.51538062,2.610358537855,
                                    0.0000000001855996,485.60320176,-0.112246363060,
                                    0.0000000001855996,-485.60320175,0.112246363894,
                                    0.0000000001507209,-254.63444650,-0.161685950186,
                                    0.0000000001507209,254.63444650,0.161685950186,
                                    0.0000000000724860,2059.62104200,2.190529222727,
                                    0.0000000000724860,-2059.62104200,-2.190529222727,
                                    0.0000000000272746,-274.02279431,-1.229708703052,
                                    0.0000000000272746,274.02279431,1.229708703058,
                                    0.0000000000163051,250.13067987,2.545191166411,
                                    0.0000000000163051,-250.13067987,-2.545191131299
                            },
                            {
                                    0.0000962629174333,-462.51460360,1.138619193016,
                                    0.0000962629174333,462.51460361,-1.138619147350,
                                    0.0000485401798038,482.05605148,-0.185051689928,
                                    0.0000485401798038,-482.05605148,0.185051701631,
                                    0.0000449408708250,-2059.62271753,2.521072536783,
                                    0.0000449408708250,2059.62271753,-2.521072536783,
                                    0.0000276550525131,-485.60320179,-1.458550472778,
                                    0.0000276550525131,485.60320179,1.458550472730,
                                    0.0000209039435245,-403.51538158,2.102023003408,
                                    0.0000209039435245,403.51538158,-2.102022944892,
                                    0.0000186178298694,4332.93914977,2.108666755900,
                                    0.0000186178298694,-4332.93914965,-2.108666744160,
                                    0.0000117220266508,254.63444653,1.732483394545,
                                    0.0000117220266508,-254.63444653,-1.732483394547,
                                    0.0000080156582120,-66002.48715215,0.073578008624,
                                    0.0000080156582120,66002.48716936,-0.073578000960,
                                    0.0000041114727746,-11428.11256828,2.016207414938,
                                    0.0000041114727746,11428.11256829,-2.016207414823,
                                    0.0000043608559052,14133.23625267,0.738064832500,
                                    0.0000043608559052,-14133.23624426,-0.738064751637,
                                    0.0000037682740860,9692.27262460,1.002642850091,
                                    0.0000037682740860,-9692.27262347,-1.002642825467,
                                    0.0000026598151336,2166.51917628,-0.118101155294,
                                    0.0000026598151336,-2166.51917619,0.118101190565
                            },
                            {
                                    0.0041510849668155,-486.80959494,2.009725283179,
                                    0.0000352747346169,49367.32662218,0.253909334368,
                                    0.0000198194483636,195946.92419811,1.897179483608,
                                    0.0000146399842989,2358.32875876,1.478395862207,
                                    0.0000052220588690,9267.76794016,2.447815000610,
                                    0.0000022044764663,-237.17561538,-1.564292084282,
                                    0.0000015410375360,2265.74291645,-1.823335732733,
                                    0.0000012193607962,-637.45860369,-1.957542685623
                            },
                            {
                                    0.0003142172466014,-2714.00626203,0.017009891895,
                                    0.0000904169207946,-11038.50115941,2.090564874290,
                                    0.0000164452324013,-50300.46261866,-1.808667780761,
                                    0.0000055424829091,-205593.77774416,2.907426236797,
                                    0.0000035856270353,-248.89302051,1.928881950702,
                                    0.0000024180760140,2166.34061401,2.301952132272,
                                    0.0000008673084930,-4333.05393383,1.875397350363,
                                    0.0000003176227277,-267.38514937,0.860886171255,
                                    0.0000003152816608,1444.25588657,2.837887905087,
                                    0.0000002338676726,4332.83109038,-2.991881157330,
                                    0.0000001754553689,-244.58835226,-0.454720421567,
                                    0.0000001286319583,-243.40543219,1.572977535435,
                                    0.0000000967213304,-2166.50569931,-1.943113737418
                            }
                    },
                    {
                            {
                                    0.0000000090655385,482.05605605,1.385772645301,
                                    0.0000000090655385,-482.05605605,-1.385772633599,
                                    0.0000000047683565,-485.60320520,-3.029413042035,
                                    0.0000000047683565,485.60320520,3.029413042096,
                                    0.0000000035969671,462.51472501,-2.707591871848,
                                    0.0000000035969671,-462.51472501,2.707591896577,
                                    0.0000000008232399,-403.51538403,0.531187191370,
                                    0.0000000008232399,403.51538403,-0.531187167963,
                                    0.0000000005125913,2059.62196661,-0.950637805889,
                                    0.0000000005125913,-2059.62196661,0.950637805889,
                                    0.0000000003478592,250.13068971,-0.596195111066,
                                    0.0000000003478592,-250.13068971,0.596195134473,
                                    0.0000000002908957,-254.63444649,2.979903215092,
                                    0.0000000002908957,254.63444649,-2.979903215092,
                                    0.0000000001698689,-241.91156453,1.867830046014,
                                    0.0000000001698689,241.91156453,-1.867830013805,
                                    0.0000000001896089,-248.89380995,2.620073542296,
                                    0.0000000001896089,248.89380995,-2.620073542267,
                                    0.0000000001269077,-274.02280385,1.911888048968,
                                    0.0000000001269077,274.02280385,-1.911888048527,
                                    0.0000000001579746,-241.02802357,-2.771389990456,
                                    0.0000000001579746,241.02802357,2.771389988517
                            },
                            {
                                    0.0004288216586468,482.05605608,2.956569304014,
                                    0.0004288216586468,-482.05605608,-2.956569292310,
                                    0.0002274791437543,485.60320524,-1.682976093416,
                                    0.0002274791437547,-485.60320524,1.682976093476,
                                    0.0001537125039667,-462.51473011,1.136719181022,
                                    0.0001537125039667,462.51473011,-1.136719137618,
                                    0.0000917031775902,-4332.93871803,-2.108663081132,
                                    0.0000917031775902,4332.93871814,2.108663092871,
                                    0.0000991193072392,2059.37736140,0.507502870024,
                                    0.0000991193072392,-2059.37736140,-0.507502870018,
                                    0.0000316144888598,-403.51538512,-1.039617955783,
                                    0.0000316144888598,403.51538512,1.039617990892,
                                    0.0000174586375148,-210240.18087863,1.750407353612,
                                    0.0000174586375134,210240.18167626,-1.750407317793,
                                    0.0000162854547323,50284.65590194,-0.490087477075,
                                    0.0000162854547324,-50284.65590078,0.490087477963,
                                    0.0000102913236930,-2166.51734380,-3.053369407734,
                                    0.0000102913236930,2166.51734389,3.053369442987,
                                    0.0000084014158127,250.13068976,0.974602969007,
                                    0.0000084014158127,-250.13068976,-0.974602933897,
                                    0.0000070356577800,254.63444650,-1.409106426418,
                                    0.0000070356577800,-254.63444650,1.409106424511,
                                    0.0000070814366803,-9676.80000028,2.607323588975,
                                    0.0000070814366803,9676.80000028,-2.607323588975,
                                    0.0000050373040117,11362.43599928,0.577394871339,
                                    0.0000050373040117,-11362.43599928,-0.577394871340,
                                    0.0000053299308810,2078.23892619,-0.021997688216,
                                    0.0000053299308811,-2078.23892619,0.021997688222,
                                    0.0000047325683320,67215.42643142,0.141213175007,
                                    0.0000047325683325,-67215.42643262,-0.141213175548,
                                    0.0000039214851670,241.91154490,-0.297536953260,
                                    0.0000039214851670,-241.91154490,0.297536962655,
                                    0.0000045554036662,248.89381141,-1.049231904996,
                                    0.0000045554036661,-248.89381141,1.049231905683
                            },
                            {
                                    0.0093589104136341,-486.80959494,-1.131867355050,
                                    0.0001980963564781,9267.59815105,-0.700195659441,
                                    0.0002139036390350,49367.31948358,0.253903838790,
                                    0.0001210388158965,196002.76969709,1.900452411216,
                                    0.0000139052321679,-242.21058266,-2.517653962057,
                                    0.0000073925894084,-243.10282624,2.121892237182,
                                    0.0000051968296512,-237.17564686,1.575472602669
                            },
                            {
                                    0.0040404917832303,-11038.50070470,2.090572293375,
                                    0.0002200421034564,-50300.46217493,-1.808667829190,
                                    0.0000590282470983,-205590.83436962,2.907535129258,
                                    0.0000105030331400,-2714.00565902,-3.124346970559,
                                    0.0000102943248250,-248.89302050,-1.212709792839,
                                    0.0000072600013020,2166.34096750,2.302095210918,
                                    0.0000018391258758,-4333.05816401,-1.266797143358,
                                    0.0000014880605763,-244.58836553,-0.455088252478,
                                    0.0000008828196274,1810.91607041,-0.522805812968,
                                    0.0000008714042768,4332.82720044,-2.991672113265,
                                    0.0000008536188044,1444.25631462,2.838189555021,
                                    0.0000006846214331,-243.40441644,1.606346686085,
                                    0.0000004471826348,-267.38514860,-2.280679314445,
                                    0.0000003034392168,-243.69327303,1.113159867990,
                                    0.0000001792048645,-3111.52953257,1.563078661742,
                                    0.0000001799083735,7133.00782851,-0.505644195617,
                                    0.0000001062153531,-11679.84994953,1.447094472227,
                                    0.0000001098546626,1277.13984095,0.006562244228,
                                    0.0000001083128732,-10479.05596460,-0.636294555123,
                                    0.0000000768496749,1083.20345403,-2.906284048843,
                                    0.0000000692273841,2076.86504405,-2.906237638896,
                                    0.0000000676969224,-14141.63136873,0.044806456994,
                                    0.0000000621559952,-461.88727875,0.684245423843
                            }
                    },
                    {
                            {
                                    0.0000000054767566,462.51465961,0.433012270674,
                                    0.0000000054767566,-462.51465961,-0.433012249211,
                                    0.0000000056033730,-482.05605692,1.755815363396,
                                    0.0000000056033730,482.05605692,-1.755815351694,
                                    0.0000000028921342,485.60320600,-0.112163580985,
                                    0.0000000028921342,-485.60320600,0.112163580799,
                                    0.0000000003409630,254.63444667,-2.979904123822,
                                    0.0000000003409630,-254.63444667,2.979904123823,
                                    0.0000000002216888,250.13068507,2.545311746332,
                                    0.0000000002216888,-250.13068507,-2.545311746332,
                                    0.0000000001418329,-241.91155085,-1.273238319314,
                                    0.0000000001418329,241.91155085,1.273238319313
                            },
                            {
                                    0.0001155398943113,4332.93886608,2.108691866697,
                                    0.0001155398943113,-4332.93886574,-2.108691831480,
                                    0.0000914317982059,-482.05605702,0.185017491519,
                                    0.0000914317982059,482.05605703,-0.185017456411,
                                    0.0000756189389102,462.51466388,2.003875199838,
                                    0.0000756189389102,-462.51466387,-2.003875175333,
                                    0.0000477739034923,485.60320603,1.458631213994,
                                    0.0000477739034926,-485.60320603,-1.458631213811,
                                    0.0000271961236501,210274.48426729,-1.785123499277,
                                    0.0000271961236540,-210274.48346940,1.785123534351,
                                    0.0000244626823237,-50284.47674577,0.491194059142,
                                    0.0000244626823247,50284.47674762,-0.491194057704,
                                    0.0000077362945254,9642.10026223,2.580679451841,
                                    0.0000077362945254,-9642.10026227,-2.580679452618,
                                    0.0000084883673229,2059.54227670,-2.558255736482,
                                    0.0000084883673229,-2059.54227670,2.558255736428,
                                    0.0000067827229369,-11287.76456818,-0.945782523799,
                                    0.0000067827229369,11287.76456818,0.945782523799,
                                    0.0000037731001815,-67979.99326489,-0.181520301079,
                                    0.0000037731001804,67979.99326458,0.181520300800,
                                    0.0000032076570609,2166.51777632,3.080339678337,
                                    0.0000032076570609,-2166.51777629,-3.080339666591,
                                    0.0000026285122860,-254.63444659,1.409111585164,
                                    0.0000026285122860,254.63444659,-1.409111565386,
                                    0.0000028282486512,14014.13678272,2.891690797470,
                                    0.0000028282486512,-14014.13678272,-2.891690797471
                            },
                            {
                                    0.0014289811307319,49367.34034574,0.253921225395,
                                    0.0007710931226760,195955.54100807,1.897688885982,
                                    0.0005925911780766,-486.80959494,2.009725311237,
                                    0.0000070808673396,-242.21058256,0.623939292029,
                                    0.0000070804404020,9270.75474882,2.567494996183,
                                    0.0000048299146941,2265.73531869,1.315002005009,
                                    0.0000038142769361,-243.10282598,-1.019683047586,
                                    0.0000022651772374,4332.66561900,0.788371189690,
                                    0.0000023143850535,2190.53482611,-0.326448440973,
                                    0.0000007268381420,-237.17572590,-1.570723011296
                            },
                            {
                                    0.0015932721570848,-50300.46317781,-1.808668110228,
                                    0.0003513347911037,-205594.76675742,2.907439275438,
                                    0.0001441929255483,-11038.50233695,-1.051046669426,
                                    0.0000157303527750,2166.34184154,2.302490124225,
                                    0.0000025161319881,-4333.06554786,-1.267594020600,
                                    0.0000020438305183,4332.81770831,-2.991340015519,
                                    0.0000017939612784,1444.25697259,2.838852837237,
                                    0.0000013614276895,-248.89302051,1.928883308456,
                                    0.0000008996109017,2076.86534892,-2.906045098558,
                                    0.0000008702078430,-2714.00571514,-3.123659682744,
                                    0.0000004371144064,-244.58835722,2.686731305626,
                                    0.0000001926397869,2142.19483368,-1.985925544377,
                                    0.0000002174259374,-243.40560179,-1.574163434803,
                                    0.0000001589279656,1083.20364160,-2.905875929922,
                                    0.0000001432228753,-3989.29234760,-2.346001284423
                            }
                    },
                    {
                            {
                                    0.0000000001238821,9641.95997751,-2.136521368996,
                                    0.0000000001238821,-9641.95997747,2.136521369695,
                                    0.0000000000937288,11292.66166947,2.658438162555,
                                    0.0000000000937288,-11292.66166870,-2.658438150854
                            },
                            {
                                    0.0002793020061912,-4332.93860171,-2.108786357946,
                                    0.0002793020061912,4332.93860182,2.108786369685,
                                    0.0001902906934088,211344.06814397,1.346615691710,
                                    0.0001902906934113,-211344.06760662,-1.346615668368,
                                    0.0000167518242157,-50289.57428101,-2.654427789777,
                                    0.0000167518242264,50289.57429022,2.654427797106,
                                    0.0000092970467736,-2166.51555964,-2.989880275328,
                                    0.0000092970467736,2166.51555970,2.989880298849,
                                    0.0000085219011443,9641.95655559,-0.565865906865,
                                    0.0000085219011444,-9641.95655560,0.565865906783,
                                    0.0000075696916557,-11291.33721849,2.059123798134,
                                    0.0000075696916557,11291.33721925,-2.059123786437,
                                    0.0000058058699386,-67440.56838013,2.926756672932,
                                    0.0000058058699344,67440.56837337,-2.926756675958
                            },
                            {
                                    0.0073755808467977,195950.90846202,1.897427359615,
                                    0.0001561131605348,49367.23074528,-2.887649087328,
                                    0.0000540660842731,2190.52954139,-0.328140763057,
                                    0.0000090411191759,4332.68219367,0.789967351008,
                                    0.0000060406575087,1454.71609134,-0.020851153251,
                                    0.0000028551622596,-198930.12372162,-0.327774752201,
                                    0.0000026588026505,4430.38639549,2.290679594163,
                                    0.0000016317841395,4238.97138743,2.407098908451,
                                    0.0000016159095087,-4430.93037398,-1.783540964911,
                                    0.0000012029942283,2265.73177106,-1.827994616498,
                                    0.0000008869382117,9192.14352819,-0.159251424576,
                                    0.0000004518928658,2164.87438400,0.627199957599,
                                    0.0000004739086661,10677.43163337,-1.721255818131,
                                    0.0000005321318002,1089.21699649,0.749679902895
                            },
                            {
                                    0.0022453891791894,-205593.16871630,2.907607823156,
                                    0.0002604479450559,-50300.45144562,1.332921952672,
                                    0.0000332112143230,2166.33408559,2.299271304157,
                                    0.0000049727136261,-4333.06038571,-1.266951160328,
                                    0.0000049416729114,-11038.56696703,-1.052098159774,
                                    0.0000043945193428,4332.82948108,-2.986950453661,
                                    0.0000037630501589,1444.25618193,2.837982671867,
                                    0.0000030823418750,2143.47705615,-1.442836410158,
                                    0.0000004637177865,-4242.89245749,2.432125315770,
                                    0.0000004719790711,4426.19806280,0.277692210330,
                                    0.0000003467132626,1433.98920963,-0.966205311247,
                                    0.0000003497224175,2076.87114473,0.238492877349,
                                    0.0000003324412570,1083.20735284,-2.900230549782,
                                    0.0000001945374351,2181.03566283,2.659258242659,
                                    0.0000001727743329,-2166.53579568,-1.915921390647,
                                    0.0000001485176585,4243.19386437,1.378730646509
                            }
                    }
            };

    private final double[][][] AFCP=
            {
                    {
                            {
                                    0.0028210960212903,0.00000000,0.000000000000,
                                    0.0000000381012294,1.76273174,-2.643895074882,
                                    0.0000000381012294,-1.76273174,2.643895075707,
                                    0.0000000086168826,3.52546349,1.819648782093,
                                    0.0000000086168826,-3.52546349,-1.819648774502,
                                    0.0000000090450162,-0.88136587,-0.995547070485,
                                    0.0000000090450162,0.88136587,0.995547070485,
                                    0.0000000047397043,-0.78343633,2.807162813908,
                                    0.0000000047397043,0.78343633,-2.807162778199,
                                    0.0000000046098133,-0.58757725,1.648484811816,
                                    0.0000000046098133,0.58757725,-1.648484776721,
                                    0.0000000050863040,0.70509270,2.815055976377,
                                    0.0000000050863040,-0.70509270,-2.815055941282,
                                    0.0000000029290802,-2.35030899,-1.158674633569,
                                    0.0000000029290802,2.35030899,1.158674656974,
                                    0.0000000017446377,0.50363764,0.171224706165,
                                    0.0000000017446377,-0.50363764,-0.171224671071,
                                    0.0000000015421426,0.98945742,-2.666154170053,
                                    0.0000000015421426,-0.98945742,2.666154193457,
                                    0.0000000018109074,-1.17515450,0.824225124590,
                                    0.0000000018109074,1.17515450,-0.824225124846,
                                    0.0000000010397325,-0.52701992,1.990665563264,
                                    0.0000000010397325,0.52701992,-1.990665563264,
                                    0.0000000005841286,0.49036751,0.489778750861,
                                    0.0000000005841286,-0.49036751,-0.489778750861,
                                    0.0000000004015988,0.61965131,2.472795335277,
                                    0.0000000004015988,-0.61965131,-2.472795323587,
                                    0.0000000003507059,-0.88493019,1.953447599078,
                                    0.0000000003507059,0.88493019,-1.953447575672,
                                    0.0000000003654755,0.75178915,0.653129619279,
                                    0.0000000003654755,-0.75178915,-0.653129619279,
                                    0.0000000002876544,0.65963828,-0.857967356136,
                                    0.0000000002876544,-0.65963828,0.857967374635,
                                    0.0000000002179774,0.95555745,-1.167011088750,
                                    0.0000000002179774,-0.95555745,1.167011088750,
                                    0.0000000001614172,1.31085840,-2.986185416058,
                                    0.0000000001614172,-1.31085840,2.986185416058,
                                    0.0000000001716490,1.97891465,1.799472338743,
                                    0.0000000001716490,-1.97891465,-1.799472336412,
                                    0.0000000000827916,1.41018540,2.978320583302,
                                    0.0000000000827916,-1.41018540,-2.978320559896,
                                    0.0000000000763996,0.84151364,-1.827565110733,
                                    0.0000000000763996,-0.84151364,1.827565116962,
                                    0.0000000000806455,2.08677541,1.477346039152,
                                    0.0000000000806455,-2.08677541,-1.477346042522,
                                    0.0000000000853835,1.76920091,-1.211307445204,
                                    0.0000000000853835,-1.76920091,1.211307445226,
                                    0.0000000000761656,1.40607178,-1.650855579663,
                                    0.0000000000761656,-1.40607178,1.650855579663,
                                    0.0000000000594344,-0.88511089,0.951017241368,
                                    0.0000000000594344,0.88511089,-0.951017239898,
                                    0.0000000000564629,0.49472871,0.950314977999,
                                    0.0000000000564629,-0.49472871,-0.950314966307,
                                    0.0000000000493043,-5.11358278,0.341909441869,
                                    0.0000000000493043,5.11358278,-0.341909430740,
                                    0.0000000000428597,1.05181306,-2.914901885532,
                                    0.0000000000428597,-1.05181306,2.914901883107,
                                    0.0000000000438860,3.49879406,0.481234140725,
                                    0.0000000000438860,-3.49879406,-0.481234137799
                            },
                            {
                                    1.4462132960212235,0.00000000,0.000000000000,
                                    0.0000251792213075,1.76273177,-1.071369371364,
                                    0.0000251792213075,-1.76273177,1.071369371632,
                                    0.0000222206385058,-3.52546349,2.892741097493,
                                    0.0000222206385058,3.52546349,-2.892741074803,
                                    0.0000054507134660,2.35030899,2.729470598014,
                                    0.0000054507134660,-2.35030899,-2.729470598014,
                                    0.0000059524877849,0.88136587,2.566011851738,
                                    0.0000059524877849,-0.88136587,-2.566011851738,
                                    0.0000028787912389,-0.78343633,1.236365304804,
                                    0.0000028787912389,0.78343633,-1.236365280939,
                                    0.0000030726401981,-0.70509270,1.897339035434,
                                    0.0000030726401981,0.70509270,-1.897339023744,
                                    0.0000023908706663,-2056.36375976,-0.211262261618,
                                    0.0000023908713552,2056.36431648,0.211277724557,
                                    0.0000022777007661,274.03235254,0.387713436622,
                                    0.0000022777007661,-274.03235254,-0.387713436591,
                                    0.0000025590603468,-0.58757725,0.077681276181,
                                    0.0000025590603468,0.58757725,-0.077681252776,
                                    0.0000021602067349,400.78715490,0.013492534637,
                                    0.0000021602067349,-400.78715480,-0.013492473587,
                                    0.0000018842049141,1.17515450,0.746568951200,
                                    0.0000018842049141,-1.17515450,-0.746568951200,
                                    0.0000015701869124,-249.77392671,2.493981352238,
                                    0.0000015701869123,249.77392671,-2.493981352263,
                                    0.0000008114937768,-10400.18449376,-1.567931706749,
                                    0.0000008114933753,10400.18102399,1.567928771616,
                                    0.0000012168267714,2471.07130547,-0.717589824480,
                                    0.0000012168291116,-2471.05875738,0.717795029776,
                                    0.0000010144950846,-0.98945742,1.095489123829,
                                    0.0000010144950846,0.98945742,-1.095489112139,
                                    0.0000009276215519,0.50363764,1.741664442016,
                                    0.0000009276215519,-0.50363764,-1.741664395199,
                                    0.0000009332719352,-462.34993510,3.008175468973,
                                    0.0000009332719348,462.34993512,-3.008175463874,
                                    0.0000001301198829,1375.10423851,-0.137037396295,
                                    0.0000001301198573,-1375.10422893,0.137037333790,
                                    0.0000004035364904,1668.45604889,-1.183442165366,
                                    0.0000004035364083,-1668.45590610,1.183447162176,
                                    0.0000006580493802,-437.59465164,-3.042608902290,
                                    0.0000006580493801,437.59465164,3.042608902840
                            },
                            {
                                    0.0006260521444113,1.76913777,1.446188898563,
                                    0.0000096819265753,3.55118107,2.768134001457,
                                    0.0000098749504021,-1.75637194,0.450761187889,
                                    0.0000083063168209,7.15455323,-2.854077904786,
                                    0.0000045951340101,-1.40611218,-2.029833930094,
                                    0.0000059689735869,0.88296443,-1.209110059349,
                                    0.0000046538995236,-1.17232451,-1.368864973222,
                                    0.0000037405126681,-0.87977305,3.094673734781,
                                    0.0000037711061757,-3.50011573,2.270416702740,
                                    0.0000018698303790,-2.24513352,-2.170781015720,
                                    0.0000013214613496,-0.70407292,1.275017772430,
                                    0.0000012707585609,16.68653361,1.972514861645,
                                    0.0000011886104747,1.17799818,0.124242374879,
                                    0.0000007689215742,-2302.10434716,0.689291076961,
                                    0.0000008742035177,2493.83004733,2.390352831189
                            },
                            {
                                    0.0000175695395780,0.00000000,2.415080967945,
                                    0.0000000000692310,-193.28859060,-2.208588622047
                            }
                    },
                    {
                            {
                                    0.0044871037804314,0.00000000,0.000000000000,
                                    0.0000002162183749,3.52546349,1.819645606290,
                                    0.0000002162183749,-3.52546349,-1.819645606290,
                                    0.0000000801807375,-2.35030899,1.982912654261,
                                    0.0000000801807375,2.35030899,-1.982912619140,
                                    0.0000000509573393,-1.17515450,-2.317355432932,
                                    0.0000000509573393,1.17515450,2.317355432932,
                                    0.0000000462367393,-7.05092698,0.660971402306,
                                    0.0000000462367393,7.05092698,-0.660971402162,
                                    0.0000000255754500,-1.41018540,-2.978330737054,
                                    0.0000000255754500,1.41018540,2.978330748744,
                                    0.0000000261832900,1.76273174,0.497691978790,
                                    0.0000000261832900,-1.76273174,-0.497691978790,
                                    0.0000000136429969,-0.70509270,0.327144622755,
                                    0.0000000136429969,0.70509270,-0.327144587998,
                                    0.0000000155953890,-0.88136587,2.146927076004,
                                    0.0000000155953890,0.88136587,-2.146927075722,
                                    0.0000000087480272,1.00727528,1.656394163933,
                                    0.0000000087480272,-1.00727528,-1.656394128838,
                                    0.0000000116112914,2.25553591,-0.022341870823,
                                    0.0000000116112914,-2.25553591,0.022341870823,
                                    0.0000000061437036,0.58757726,1.500536383468,
                                    0.0000000061437036,-0.58757726,-1.500536348490,
                                    0.0000000042431918,-0.50363764,2.970124107071,
                                    0.0000000042431918,0.50363764,-2.970124071981,
                                    0.0000000034561177,-1.50369059,0.034310693267,
                                    0.0000000034561177,1.50369059,-0.034310721884,
                                    0.0000000030688784,0.78343633,0.334349762913,
                                    0.0000000030688784,-0.78343633,-0.334349729096,
                                    0.0000000022671527,0.52701992,1.152376957614,
                                    0.0000000022671527,-0.52701992,-1.152376945916,
                                    0.0000000022287342,1.77703490,0.345978042967,
                                    0.0000000022287342,-1.77703490,-0.345978042889,
                                    0.0000000021175036,4.51107181,-0.011219786970,
                                    0.0000000021175036,-4.51107181,0.011219786970,
                                    0.0000000014391886,-0.61965131,0.669288476670,
                                    0.0000000014391886,0.61965131,-0.669288418187,
                                    0.0000000012177331,6.94927396,0.995871908751,
                                    0.0000000012177331,-6.94927396,-0.995871908751,
                                    0.0000000010786785,1.12776795,-0.045280251144,
                                    0.0000000010786785,-1.12776795,0.045280251144,
                                    0.0000000011266470,0.64099336,-0.987288717782,
                                    0.0000000011266470,-0.64099336,0.987288718396,
                                    0.0000000008265031,-0.75178905,2.504075950065,
                                    0.0000000008265031,0.75178905,-2.504075904237,
                                    0.0000000005794919,-3.55143712,3.009946487657,
                                    0.0000000005794919,3.55143712,-3.009946487654,
                                    0.0000000003807491,1.77777556,1.686281241558,
                                    0.0000000003807491,-1.77777556,-1.686281227667,
                                    0.0000000003552247,-2.60797333,0.371913588076,
                                    0.0000000003552247,2.60797333,-0.371913588692,
                                    0.0000000005101755,-0.95555743,-1.972390618495,
                                    0.0000000005101755,0.95555743,1.972390620107
                            },
                            {
                                    0.3735263437471362,0.00000000,-3.141592653403,
                                    0.0001624469912587,-3.52546349,-0.248853126552,
                                    0.0001624469912587,3.52546349,0.248853148768,
                                    0.0000717191594226,7.05092698,0.909825056364,
                                    0.0000717191594226,-7.05092698,-0.909825056364,
                                    0.0000385969570472,2.35030899,-0.412116543189,
                                    0.0000385969570472,-2.35030899,0.412116578303,
                                    0.0000218287365705,1.76273174,2.068494534904,
                                    0.0000218287365705,-1.76273174,-2.068494534904,
                                    0.0000223383238694,1.17515450,-2.395036777814,
                                    0.0000223383238694,-1.17515450,2.395036777814,
                                    0.0000096353043778,1.41018540,-1.734057827225,
                                    0.0000096353043778,-1.41018540,1.734057862320,
                                    0.0000065973457880,0.88136587,-0.574948883091,
                                    0.0000065973457880,-0.88136587,0.574948883295,
                                    0.0000048707009708,-0.70509245,-1.160449891993,
                                    0.0000048707009708,0.70509245,1.160449916162,
                                    0.0000043860283834,400.80554123,3.108492565509,
                                    0.0000043860283834,-400.80554119,-3.108492540844,
                                    0.0000037783019709,-14526.63126285,1.653763811537,
                                    0.0000037783070079,14526.64946924,-1.653758308820,
                                    0.0000052005863869,2.25553591,1.548440639446,
                                    0.0000052005863869,-2.25553591,-1.548440639370,
                                    0.0000033290495376,-274.03305205,2.753261920991,
                                    0.0000033290495376,274.03305205,-2.753261920909,
                                    0.0000029065567615,-1.00727528,3.055999599574,
                                    0.0000029065567615,1.00727528,-3.055999587858,
                                    0.0000032927071387,-240.79911272,2.850621646594,
                                    0.0000032927071387,240.79911272,-2.850621646515,
                                    0.0000027860432638,2465.81058901,2.385773248504,
                                    0.0000027860415206,-2465.81062125,-2.385773134668,
                                    0.0000024099254453,-4.51107182,-1.559634116074,
                                    0.0000024099254453,4.51107182,1.559634116074,
                                    0.0000021364215633,0.58757722,3.051294967909,
                                    0.0000021364215633,-0.58757722,-3.051294932621,
                                    0.0000021087772652,-2082.97789867,0.219861989989,
                                    0.0000021087773173,2082.97802228,-0.219858903141,
                                    0.0000018853812260,249.13840056,-2.750530921943,
                                    0.0000018853812260,-249.13840055,2.750530930849
                            },
                            {
                                    0.0002988994545555,3.55118107,-0.373458788613,
                                    0.0000823525166369,1.76913777,1.446188770927,
                                    0.0000837042048393,-6.95025971,1.609453836719,
                                    0.0000278946698536,-3.50011572,-0.871155222557,
                                    0.0000315906532820,7.15455323,-2.854080409609,
                                    0.0000294503681314,-1.75637194,-2.690812623889,
                                    0.0000144958688621,-2.33901625,2.931395664158,
                                    0.0000108374431350,-6.18210653,-0.351109195546,
                                    0.0000082175838585,-1.17232451,1.772880355220,
                                    0.0000062618381566,-0.87977309,-0.057891668832,
                                    0.0000041298266970,-1.40611218,-2.029848170071,
                                    0.0000043507065743,16.68653641,1.973436581069,
                                    0.0000042081682285,1.41426445,3.120261383685,
                                    0.0000027357551003,-0.70407293,-1.868111985056,
                                    0.0000036991221930,2.36171130,2.107163763597,
                                    0.0000020163445050,-2.60801351,-0.434765781769,
                                    0.0000026854901206,397.49502864,-2.385626020918,
                                    0.0000017894118824,-0.58686890,2.596961125563,
                                    0.0000023074479953,0.88296447,1.943899853407,
                                    0.0000018159137522,1.00936379,2.604869046210,
                                    0.0000011726743714,-437.81569630,1.882700621195,
                                    0.0000016518864520,1.17799818,-3.017336059369,
                                    0.0000018506530067,9207.93895292,-0.457770143364,
                                    0.0000013196935928,-1.00519540,-0.707882741855,
                                    0.0000014426949422,-3.55690202,-0.281777715997,
                                    0.0000015660692561,-548.57786416,3.037342396932,
                                    0.0000005646670312,-488.13559324,2.168360257491,
                                    0.0000007495662748,3126.34340655,-0.151955418922,
                                    0.0000007569857746,-2303.92749369,0.668283437067,
                                    0.0000009550285338,4406.90403072,-0.300652348938,
                                    0.0000007091149133,-3153.42860903,2.713933181549,
                                    0.0000002004455524,-1919.99999983,-1.852207712464,
                                    0.0000001623489363,1408.49105459,-2.899698107364,
                                    0.0000001058862562,1599.99999991,-1.747489966524
                            },
                            {
                                    0.0001662544744719,0.00000000,2.413486237501,
                                    0.0000000000608298,-193.26413985,-2.230228354541
                            }
                    },
                    {
                            {
                                    0.0071566594572575,0.00000000,0.000000000000,
                                    0.0000006965149555,-2.35030899,-1.158674588527,
                                    0.0000006965149555,2.35030899,1.158674600230,
                                    0.0000003224914673,7.05092698,-0.660970737035,
                                    0.0000003224914673,-7.05092698,0.660970737035,
                                    0.0000001149029760,-6.26162437,-1.299592404339,
                                    0.0000001149029760,6.26162437,1.299592404339,
                                    0.0000000610717185,-3.52546349,-1.819650979517,
                                    0.0000000610717185,3.52546349,1.819651032396,
                                    0.0000000547899088,4.17441617,1.948670877782,
                                    0.0000000547899088,-4.17441617,-1.948670828180,
                                    0.0000000350717808,-12.52324882,-0.649785081154,
                                    0.0000000350717808,12.52324882,0.649785104562,
                                    0.0000000273934283,-3.13081218,-2.599205067142,
                                    0.0000000273934283,3.13081218,2.599205102257,
                                    0.0000000181610714,-1.76273174,-0.497708209553,
                                    0.0000000181610714,1.76273174,0.497708210129,
                                    0.0000000197317929,1.17515450,-0.824239093090,
                                    0.0000000197317929,-1.17515450,0.824239093704,
                                    0.0000000140622484,-2.50464974,3.034184231000,
                                    0.0000000140622484,2.50464974,-3.034184231000,
                                    0.0000000103962349,1.41018540,-0.163261763515,
                                    0.0000000103962349,-1.41018540,0.163261798610,
                                    0.0000000145474682,-3.58319300,-2.012339222997,
                                    0.0000000145474682,3.58319300,2.012339225153,
                                    0.0000000073448387,2.08720812,-2.384360905770,
                                    0.0000000073448387,-2.08720812,2.384360906102,
                                    0.0000000059965021,-1.00727528,1.485195822039,
                                    0.0000000059965021,1.00727528,-1.485195786944,
                                    0.0000000049933886,10.02108773,0.967007202582,
                                    0.0000000049933886,-10.02108773,-0.967007214068,
                                    0.0000000038834130,1.78903553,-1.734548005475,
                                    0.0000000038834130,-1.78903553,1.734548012548,
                                    0.0000000033173319,0.78343633,0.334410735342,
                                    0.0000000033173319,-0.78343633,-0.334410703853,
                                    0.0000000037071986,50.13968535,0.161404498578,
                                    0.0000000037071986,-50.13968535,-0.161404499697,
                                    0.0000000024697553,3.58615746,3.014796806223,
                                    0.0000000024697553,-3.58615746,-3.014796771059,
                                    0.0000000027884176,5.56655476,1.323585106216,
                                    0.0000000027884176,-5.56655476,-1.323585106216,
                                    0.0000000020719852,1.56540608,-1.084729476400,
                                    0.0000000020719852,-1.56540608,1.084729523216,
                                    0.0000000018431031,0.58757726,1.497090964345,
                                    0.0000000018431031,-0.58757726,-1.497090952676,
                                    0.0000000016808769,7.15554098,-2.533819463034,
                                    0.0000000016808769,-7.15554098,2.533819476120,
                                    0.0000000020382815,-0.88136587,2.146155229321,
                                    0.0000000020382815,0.88136587,-2.146155229461,
                                    0.0000000016674142,3.85367596,2.266819681887,
                                    0.0000000016674142,-3.85367596,-2.266819678138,
                                    0.0000000012877349,-3.49986546,2.808660684496,
                                    0.0000000012877349,3.49986546,-2.808660671629,
                                    0.0000000012181542,55.93578462,1.960483840747,
                                    0.0000000012181542,-55.93578462,-1.960483829044,
                                    0.0000000010016338,-2.94686240,-2.916664806186,
                                    0.0000000010016338,2.94686240,2.916664806820,
                                    0.0000000009057853,-6.94927480,2.143765079507,
                                    0.0000000009057853,6.94927480,-2.143765093634,
                                    0.0000000011132716,-1.39147207,0.434910736795,
                                    0.0000000011132716,1.39147207,-0.434910734723,
                                    0.0000000007267503,0.70508749,1.874821204178,
                                    0.0000000007267503,-0.70508749,-1.874821204178
                            },
                            {
                                    0.2874089391143348,0.00000000,0.000000000000,
                                    0.0000581860484889,-2.35030899,0.412122994161,
                                    0.0000581860484889,2.35030899,-0.412122959047,
                                    0.0000407623427232,-7.05092698,2.231767920686,
                                    0.0000407623427232,7.05092698,-2.231767920577,
                                    0.0000400609839801,6.26162437,2.870388622006,
                                    0.0000400609839801,-6.26162437,-2.870388622006,
                                    0.0000303508630091,12.52324880,2.220584023571,
                                    0.0000303508630091,-12.52324880,-2.220583988461,
                                    0.0000213787490768,3.52546349,-2.892737639574,
                                    0.0000213787490768,-3.52546349,2.892737684197,
                                    0.0000153680208913,4.17441628,-2.762551710070,
                                    0.0000153680208913,-4.17441628,2.762551710070,
                                    0.0000067324310952,-3.13081218,2.113191687546,
                                    0.0000067324310952,3.13081218,-2.113191675837,
                                    0.0000072634431824,-50.14182397,-1.759435081522,
                                    0.0000072634431824,50.14182397,1.759435084589,
                                    0.0000043977562585,-1.76273174,-2.068506076335,
                                    0.0000043977562585,1.76273174,2.068506076335,
                                    0.0000047762008660,1.17515450,0.746555718634,
                                    0.0000047762008660,-1.17515450,-0.746555718634,
                                    0.0000031610812971,-2.50464974,1.463376735121,
                                    0.0000031610812971,2.50464974,-1.463376734852,
                                    0.0000035573097979,-3.58319294,2.700332818172,
                                    0.0000035573097979,3.58319294,-2.700332827650,
                                    0.0000023282599410,14399.99998683,-1.099877635453,
                                    0.0000023282599359,-14399.99998683,1.099877639624,
                                    0.0000023502114735,-10.02107511,-2.536966831342,
                                    0.0000023502114735,10.02107511,2.536966842808,
                                    0.0000023510383997,1.41018540,1.407535452307,
                                    0.0000023510383997,-1.41018540,-1.407535440592,
                                    0.0000021174661004,55.93578577,-2.751914513472,
                                    0.0000021174661004,-55.93578577,2.751914548581,
                                    0.0000016288866844,-3679.84840303,-0.973793744174,
                                    0.0000016288866845,3679.84840303,0.973793744140,
                                    0.0000019377870959,-249.86158491,2.450426504098,
                                    0.0000019377870959,249.86158492,-2.450426503434
                            },
                            {
                                    0.0002045597496146,-50.17098410,-1.011816940225,
                                    0.0001785118648258,7.15455319,0.287431567198,
                                    0.0001131999784893,1.76913777,1.446212727724,
                                    0.0000658778169210,-3.50011574,-0.871350254578,
                                    0.0000497058888328,3.55118106,-0.373506086712,
                                    0.0000316384926978,-6.95025977,-1.532287159698,
                                    0.0000287801237327,-10.02171452,-1.661453180348,
                                    0.0000181744317896,16.68901713,2.779471484341,
                                    0.0000105558175161,-5.56684974,-2.311166167228,
                                    0.0000057610853129,-1.40611219,1.111461108666,
                                    0.0000061046181888,-7.17825897,-1.726424077467,
                                    0.0000057310334964,-2.33901627,-0.210412331329,
                                    0.0000046610005483,-3.85376806,-2.960887284255,
                                    0.0000034982417330,3.33918688,1.586656801126,
                                    0.0000030091617315,-1.75637195,0.450524745204,
                                    0.0000024732926446,25.01011480,2.204580355873,
                                    0.0000024171568015,0.00000000,-2.832382068191,
                                    0.0000022247695560,-2.94691618,2.672542463618,
                                    0.0000020947921969,2.63625763,2.235037411637,
                                    0.0000024416432533,-25.08296275,-1.578237604387,
                                    0.0000014042712722,4.55326510,-2.204412209524,
                                    0.0000011180389240,-1.17232452,1.772399331347,
                                    0.0000010371714944,-7.19017077,-2.734365259635,
                                    0.0000011076384510,-2.38555726,2.022753854104,
                                    0.0000011932531874,2.17780908,2.886194141381,
                                    0.0000007178049665,2.36171130,2.107149695705,
                                    0.0000006908412319,-8.35287888,-2.223571888688,
                                    0.0000006659820028,1.85518927,-2.747232277664,
                                    0.0000006772314920,2.38747924,2.301347989676,
                                    0.0000008993128501,-0.87977305,-0.047323465226,
                                    0.0000006286307601,0.88296448,-1.197531764168,
                                    0.0000006784151570,1478.51706690,0.743089169080,
                                    0.0000005660807396,-2.00384437,1.372931645641,
                                    0.0000006339665249,1.41428228,0.785273916249,
                                    0.0000006128705113,1.00936322,-0.638851146096,
                                    0.0000005206551413,-1.00519540,2.433337444677,
                                    0.0000004583970422,-0.64015046,-1.206485628814,
                                    0.0000003466029660,397.49139960,0.754124274965,
                                    0.0000004577854173,3.57743657,3.093485444125,
                                    0.0000004718481418,37429.59476194,1.395067854967
                            },
                            {
                                    0.0008533093128905,0.00000000,2.413388168755,
                                    0.0000000926213408,-243.69680308,-0.936338792860,
                                    0.0000000000106902,-192.66710225,-1.706763976490
                            }
                    },
                    {
                            {
                                    0.0125879701715314,0.00000000,0.000000000000,
                                    0.0000013790105326,-1.97891484,-1.808423578125,
                                    0.0000013790105326,1.97891484,1.808423589815,
                                    0.0000017976024735,12.52324852,0.649657760137,
                                    0.0000017976024735,-12.52324852,-0.649657760137,
                                    0.0000006437448086,-4.51107179,0.011294478638,
                                    0.0000006437448086,4.51107179,-0.011294478574,
                                    0.0000002086864553,-6.26162422,1.842527624347,
                                    0.0000002086864553,6.26162422,-1.842527612645,
                                    0.0000001395378859,8.37677335,0.714288700422,
                                    0.0000001395378859,-8.37677335,-0.714288676300,
                                    0.0000000999126129,4.17441617,-1.192604552413,
                                    0.0000000999126129,-4.17441617,1.192604552682,
                                    0.0000000500574919,-3.13081213,0.542875780384,
                                    0.0000000500574919,3.13081213,-0.542875768668,
                                    0.0000000256983546,2.50464971,0.106887217028,
                                    0.0000000256983546,-2.50464971,-0.106887217655,
                                    0.0000000237843996,-8.39299929,-1.721959538178,
                                    0.0000000237843996,8.39299929,1.721959573291,
                                    0.0000000174121120,16.69021715,0.150827135054,
                                    0.0000000174121120,-16.69021715,-0.150827135054,
                                    0.0000000119553173,10.02131069,-1.925833362861,
                                    0.0000000119553173,-10.02131069,1.925833397083,
                                    0.0000000131617319,-2.08719489,-0.208389567476,
                                    0.0000000131617319,2.08719489,0.208389567476,
                                    0.0000000141920315,-50.14242063,1.115887970655,
                                    0.0000000141920315,50.14242063,-1.115887945684,
                                    0.0000000109988711,2.24510856,1.507540480873,
                                    0.0000000109988711,-2.24510856,-1.507540445897,
                                    0.0000000085572239,-2.25553590,-3.119143532879,
                                    0.0000000085572239,2.25553590,3.119143533646,
                                    0.0000000070978417,-1.78903551,-1.406515118334,
                                    0.0000000070978417,1.78903551,1.406515133811,
                                    0.0000000060001815,-5.56672420,1.283203905605,
                                    0.0000000060001815,5.56672420,-1.283203904944,
                                    0.0000000054209452,-0.93228920,0.795871427118,
                                    0.0000000054209452,0.93228920,-0.795871427118,
                                    0.0000000054109127,6.18191832,-0.305922255492,
                                    0.0000000054109127,-6.18191832,0.305922255492
                            },
                            {
                                    0.3620341291375704,0.00000000,-3.141592653590,
                                    0.0001102576431631,-12.52324875,0.920999800869,
                                    0.0001102576431631,12.52324875,-0.920999800869,
                                    0.0000938947575579,1.97891484,0.237682433552,
                                    0.0000938947575579,-1.97891484,-0.237682433079,
                                    0.0000383458487621,4.51107181,-1.581970202032,
                                    0.0000383458487621,-4.51107181,1.581970202035,
                                    0.0000373528427553,6.26162437,-0.271204706549,
                                    0.0000373528427553,-6.26162437,0.271204706549,
                                    0.0000194161648683,8.37677211,2.283688674383,
                                    0.0000194161648683,-8.37677211,-2.283688674381,
                                    0.0000146516338969,-4.17441624,-0.378597607197,
                                    0.0000146516338969,4.17441624,0.378597607197,
                                    0.0000064963948341,3.13081218,1.028401028095,
                                    0.0000064963948341,-3.13081218,-1.028401016392,
                                    0.0000074412818628,-50.14197245,1.380281518586,
                                    0.0000074412818628,50.14197245,-1.380281518587,
                                    0.0000032693721243,3796.36874430,1.987215709322,
                                    0.0000032693721243,-3796.36874429,-1.987215709307,
                                    0.0000033105851447,-8.39299149,2.997485814677,
                                    0.0000033105851447,8.39299149,-2.997485813557,
                                    0.0000030790399070,2.50464974,1.678207462150,
                                    0.0000030790399070,-2.50464974,-1.678207462150,
                                    0.0000023398570389,-10.02107449,0.604674627622,
                                    0.0000023398570389,10.02107449,-0.604674593224
                            },
                            {
                                    0.0002065924169942,16.68901704,-0.362202150664,
                                    0.0001589869764021,7.15455319,0.287440062412,
                                    0.0001486043380971,1.76913777,1.446213430046,
                                    0.0000635073108731,3.55118106,-0.373504978601,
                                    0.0000599351698525,-2.24513352,-2.170633548755,
                                    0.0000489596900866,-10.02171449,1.480222294735,
                                    0.0000333682283528,-16.81857729,-1.076487783264,
                                    0.0000292325461337,-50.17099062,-1.012422966902,
                                    0.0000295832427279,-6.18210646,-0.350915517480,
                                    0.0000197588369441,0.00000000,-2.951408504882,
                                    0.0000183551029746,-5.56684974,0.830451671341,
                                    0.0000081987970452,-3.85376806,0.180738718447,
                                    0.0000039403527376,-2.94691618,-0.469009428127,
                                    0.0000056895636122,-16.88411373,-2.084089640414,
                                    0.0000040434854859,-25.08297371,1.559247963578,
                                    0.0000036901291978,5.57732714,0.352077722692,
                                    0.0000019322089806,25.00957616,-1.141325761390,
                                    0.0000019711212463,-2.38555726,-1.118790685515,
                                    0.0000018673159813,4.55326506,-2.204843732624,
                                    0.0000016695689644,3.33918689,-1.554811604707,
                                    0.0000014034621874,-2.60801097,2.801758550422,
                                    0.0000011758260607,-8.35287933,0.916517243491,
                                    0.0000016838424078,8.34481080,-0.203581964410,
                                    0.0000010798624964,2.63625769,-0.905106521704,
                                    0.0000010108880552,-2.00384437,-1.768605450166,
                                    0.0000008876681807,-12.52396907,1.911818107846,
                                    0.0000008194699011,-16.75354536,3.077495182201,
                                    0.0000006728737059,-16.95016232,-3.092183700860,
                                    0.0000006297345982,5.58451544,1.359571973412,
                                    0.0000006128899757,0.88296471,-1.142969177277,
                                    0.0000007093782158,-2.59408012,-1.871354043032,
                                    0.0000005580987049,-5.01075568,0.270180657271
                            },
                            {
                                    0.0038422977898495,0.00000000,2.413392208631,
                                    0.0000000000666922,-192.00000000,-2.221562730997
                            }
                    }
            };

    // First valid date
    private final GregorianCalendar firstValidDate;

    // Last valid date
    private final GregorianCalendar lastValidDate;

    // First valid date for accurate computation
    private final GregorianCalendar firstValidDateAccurate;

    // Last valid date for accurate computation
    private final GregorianCalendar lastValidDateAccurate;

    // Bodies for which ephemeris can be computed or approximated
    private static List<String> bodies;

    // Singleton instance
    private static IEphemeris instance = null;

    /**
     * Constructor. Singleton pattern.
     */
    private EphemerisGalileanMoons() {
        // Bodies for which ephemeris can be computed or approximated
        bodies = new ArrayList<>();
        bodies.add("Io");
        bodies.add("Europa");
        bodies.add("Ganymede");
        bodies.add("Callisto");

        // First valid date 3000 BC
        firstValidDate = new GregorianCalendar(3000,0,1);
        firstValidDate.set(Calendar.ERA, GregorianCalendar.BC);
        firstValidDate.setTimeZone(TimeZone.getTimeZone("UTC"));

        // Last valid date 3000 AD
        lastValidDate = new GregorianCalendar(3000,0,1);
        lastValidDate.setTimeZone(TimeZone.getTimeZone("UTC"));

        // First valid date for accurate computation 1150 AD
        firstValidDateAccurate = new GregorianCalendar(1150,0,1);
        firstValidDateAccurate .setTimeZone(TimeZone.getTimeZone("UTC"));

        // Last valid date for accurate computation 2750 AD
        lastValidDateAccurate = new GregorianCalendar(2750,0,1);
        lastValidDateAccurate .setTimeZone(TimeZone.getTimeZone("UTC"));
    }

    /**
     * Get instance of EphemerisSolarSystem.
     * @return instance
     */
    public static IEphemeris getInstance() {
        if (instance == null) {
            instance = new EphemerisGalileanMoons();
        }
        return instance;
    }

    @Override
    public GregorianCalendar getFirstValidDate() {
        return firstValidDate;
    }

    @Override
    public GregorianCalendar getLastValidDate() {
        return lastValidDate;
    }

    @Override
    public List<String> getBodies() {
        return Collections.unmodifiableList(bodies);
    }

    @Override
    public Vector3D getBodyPosition(String name, GregorianCalendar date) {
        return getBodyPositionVelocity(name,date)[0];
    }

    @Override
    public Vector3D getBodyVelocity(String name, GregorianCalendar date) {
        return getBodyPositionVelocity(name,date)[1];
    }

    @Override
    public Vector3D[] getBodyPositionVelocity(String name, GregorianCalendar date) {
        // Check whether body name is valid
        if (!bodies.contains(name)) {
            throw new IllegalArgumentException("Unknown body " + name + " for Galilean Moons Ephemeris");
        }

        // Check whether date is valid
        if (date.before(firstValidDate) || date.after(lastValidDate)) {
            throw new IllegalArgumentException("Date not valid for Galilean Moons Ephemeris");
        }

        // Compute Ephemeris Time
        double ET = JulianDateConverter.convertCalendarToJulianDate(date);

        // Determine satellite number
        int nsat = bodies.indexOf(name) + 1;

        // Check whether Accurate Ephemeris can be used
        if (!date.before(firstValidDateAccurate) && !date.after(lastValidDateAccurate)) {
            return getPositionVelocity(ET,nsat,1);
        }
        else {
            return getPositionVelocity(ET,nsat,0);
        }
    }

    @Override
    public Vector3D getBodyPositionBarycenter(String name, GregorianCalendar date) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    public Vector3D getBodyVelocityBarycenter(String name, GregorianCalendar date) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    public Vector3D[] getBodyPositionVelocityBarycenter(String name, GregorianCalendar date) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    private void bnlp(double dat0, int nsat, int is, double[] ELEM)
    {
        int nfm=201;
        double[] AMP = new double[nfm];
        double[] PER = new double[nfm];
        double[] PHASE = new double[nfm];
        double[][] c = new double[10][21];
        double[] val = new double[6];
        double[] NBF = new double[5];
        double[] TN = new double[9];
        double RE_ICOMP;
        double IM_ICOMP;
        double RE_RESULT;
        double IM_RESULT;
        RE_ICOMP = 0.0;
        IM_ICOMP = 1.0;
        double dat=dat0+310910.16;
        int n=0;
        for (int I=1; I<=20; I++) {
            for (int j=1; j<=9; j++) {
                c[j][I] = coefcheb[n];
                n = n + 1;
            }
        }
        if (nsat==1) {
            NBF[1]=16;
            NBF[2]=24;
            NBF[3]=8;
            NBF[4]=13;
        }
        if (nsat==2) {
            NBF[1]=22;
            NBF[2]=34;
            NBF[3]=7;
            NBF[4]=23;
        }
        if (nsat==3) {
            NBF[1]=12;
            NBF[2]=26;
            NBF[3]=10;
            NBF[4]=15;
        }
        if (nsat==4) {
            NBF[1]=4;
            NBF[2]=14;
            NBF[3]=14;
            NBF[4]=16;
        }
        for (int ib=1; ib<=4; ib++)
        {
            for (int j=1; j<=5; j++) val[j]=0.0;
            RE_RESULT=0.0;
            IM_RESULT=0.0;
            if (is == 1)
            {
                double a=-819.727638594856;
                double b=812.721806990360;
                double x=(dat0/365.25-0.5*(b+a))/(0.5*(b-a));
                TN[0]=1.0;
                TN[1]=x;
                for (int it=2; it<=8; it++)
                {
                    TN[it]=2.0*x*TN[it-1]-TN[it-2];
                }
                for (int nv=1; nv<=5; nv++)
                {
                    int nv2=nv+(nsat-1)*5;
                    for (int it=0; it<=8; it++)
                    {
                        val[nv]=val[nv]+c[it+1][nv2]*TN[it];
                    }
                    val[nv]=val[nv]-0.5*c[1][nv2];
                }
            }
            for (int j=1; j<=NBF[ib]; j++)
            {
                AMP[j]= AF[nsat-1][ib-1][(j-1)*3];
                PER[j]= AF[nsat-1][ib-1][(j-1)*3+1];
                PHASE[j] = AF[nsat-1][ib-1][(j-1)*3+2];
                if (PER[j]==0.0)
                {
                    RE_RESULT = RE_RESULT + AMP[j]*Math.cos(PHASE[j]);
                    IM_RESULT = IM_RESULT + AMP[j]*Math.sin(PHASE[j]);
                }
                else
                {
                    double phi1 = (2.0*Math.PI/PER[j])*dat+PHASE[j];
                    RE_RESULT = RE_RESULT + AMP[j]*Math.cos(phi1);
                    IM_RESULT = IM_RESULT + AMP[j]*Math.sin(phi1);
                }
            }
            if (ib==1) ELEM[ib]=RE_RESULT;
            if (ib==2) ELEM[ib]=RE_RESULT+val[1];
            if (ib>2)
            {
                ELEM[2*(ib-2)+1]=RE_RESULT+val[2*(ib-2)];
                ELEM[2*(ib-2)+2]=IM_RESULT+val[2*(ib-2)+1];
            }
        }
    }

    private void bncp(double dat0, int nsat, double[] ELEM)
    {
        int nfm=201;
        double[] AMP = new double[nfm];
        double[] PER = new double[nfm];
        double[] PHASE = new double[nfm];
        double[] NBF = new double[5];
        double RE_ICOMP;
        double IM_ICOMP;
        double RE_RESULT;
        double IM_RESULT;
        RE_ICOMP = 0.0;
        IM_ICOMP = 1.0;

        if (nsat==1) {
            NBF[1]=59;
            NBF[2]=41;
            NBF[3]=15;
            NBF[4]=2;
        }
        if (nsat==2) {
            NBF[1]=53;
            NBF[2]=39;
            NBF[3]=34;
            NBF[4]=2;
        }
        if (nsat==3) {
            NBF[1]=63;
            NBF[2]=37;
            NBF[3]=40;
            NBF[4]=3;
        }
        if (nsat==4) {
            NBF[1]=39;
            NBF[2]=25;
            NBF[3]=32;
            NBF[4]=2;
        }

        for (int ib=1; ib<=4; ib++)
        {
            RE_RESULT=0.0;
            IM_RESULT=0.0;
            for (int j=1; j<=NBF[ib]; j++)
            {
                AMP[j]= AFCP[nsat-1][ib-1][(j-1)*3];
                PER[j]= AFCP[nsat-1][ib-1][(j-1)*3+1];
                PHASE[j] = AFCP[nsat-1][ib-1][(j-1)*3+2];
                if (PER[j]==0.0)
                {
                    RE_RESULT = RE_RESULT + AMP[j]*Math.cos(PHASE[j]);
                    IM_RESULT = IM_RESULT + AMP[j]*Math.sin(PHASE[j]);
                }
                else
                {
                    double phi1 = (2.0*Math.PI/PER[j])*dat0+PHASE[j];
                    RE_RESULT = RE_RESULT + AMP[j]*Math.cos(phi1);
                    IM_RESULT = IM_RESULT + AMP[j]*Math.sin(phi1);
                }
            }
            if (ib<=2) ELEM[ib]=RE_RESULT;
            if (ib>2)
            {
                ELEM[2*(ib-2)+1]=RE_RESULT;
                ELEM[2*(ib-2)+2]=IM_RESULT;
            }
        }
    }

    private static void ELEM2PV(double MU, double[] ELEM, double[] XV)
    {
        double[] G;
        double[] E;
        G= new double[3];
        E= new double[3];
        double K=ELEM[3];
        double H=ELEM[4];
        double Q=ELEM[5];
        double P=ELEM[6];
        double A=ELEM[1];
        double AL=ELEM[2];
        double AN=Math.sqrt(MU/(A*A*A));
        double EE=AL+K*Math.sin(AL)-H*Math.cos(AL);
        double CE,SE,DE;
        do {
            CE = Math.cos(EE);
            SE = Math.sin(EE);
            DE = (AL - EE + K * SE - H * CE) / (1.0 - K * CE - H * SE);
            EE = EE + DE;
            // } while (Math.abs(DE)>=1e-12);
        } while (Math.abs(DE)>=1e-14);
        CE=Math.cos(EE);
        SE=Math.sin(EE);
        double DLE=H*CE-K*SE;
        double RSAM1=-K*CE-H*SE ;
        double ASR=1.0/(1.0+RSAM1);
        double PHI=Math.sqrt(1.0-K*K-H*H) ;
        double PSI=1.0/(1.0+PHI) ;
        double X1=A*(CE-K-PSI*H*DLE) ;
        double Y1=A*(SE-H+PSI*K*DLE) ;
        double VX1=AN*ASR*A*(-SE-PSI*H*RSAM1) ;
        double VY1=AN*ASR*A*( CE+PSI*K*RSAM1) ;
        double F2=2.0*Math.sqrt(1.0-Q*Q-P*P) ;
        double P2=1.0-2.0*P*P ;
        double Q2=1.0-2.0*Q*Q ;
        double PQ=2.0*P*Q ;
        XV[1]=X1*P2+Y1*PQ ;
        XV[2]=X1*PQ+Y1*Q2 ;
        XV[3]=(Q*Y1-X1*P)*F2 ;
        XV[4]=VX1*P2+VY1*PQ ;
        XV[5]=VX1*PQ+VY1*Q2 ;
        XV[6]=(Q*VY1-VX1*P)*F2  ;
    }

    private Vector3D[] getPositionVelocity(double ET, int nsat, int is)
    {
        //!*  From original explanation in Fortran code:
        //!*  ET : Time in Julian days (TDB) starting at the epoch 2433282.5 (01/01/1950 a 0H00 (TDB))
        //!* nsat: satellite number (1 Io, 2 Europa, 3 Ganymede, 4 Callisto)
        //!*  is : computation of the Solar long periods (0=no, 1=yes), see below
        //!* return: (x,y,z,vx,vy,vz), Jovian centered Cartesian coordinates in J2000 Earth mean equatorial frame                                 *

        // This method delivers the ephemerides of the Galilean moons.
        // It is based on a numerical model fitted to observations dispatched
        // from 1891 to 2003. The expected accuracy of these ephemerides is
        // few hundreds of kilometers for the period [1970:2010].

        // There are no explicit time limit in the use of this subroutine.
        // For request outside the period [1150:2750], the computation of the
        // Solar long period must be deactivated (set value "is" to 0).

        // double UA=149597870.691; // km
        double UA = SolarSystemParameters.ASTRONOMICALUNIT; // m
        double SEC_PER_DAY=86400.0;
        double[] ELEM=new double[7];
        double[] ELEMCP=new double[7];
        double[] L=new double[5];
        double[] XV=new double[7];
        double[] MU=new double[5];
        L[1]=3.55155228618240;
        L[2]=1.76932271112347;
        L[3]=0.878207923589328;
        L[4]=0.376486233433828;
        double ome=6.24950183065715;
        double ainc=0.445094736497665;

        MU[1]=2.82489428433814E-07;
        MU[2]=2.82483274392893E-07;
        MU[3]=2.82498184184723E-07;
        MU[4]=2.82492144889909E-07;

        ET = ET - 2433282.5;
        bnlp(ET,nsat,is,ELEM);
        bncp(ET,nsat,ELEMCP);
        for (int i=1;i<=6;i++)
        {
            ELEM[i]=ELEM[i]+ELEMCP[i];
        }
        ELEM[2]=ELEM[2]+L[nsat]*ET;
        double XX=Math.cos(ELEM[2]);
        double YY=Math.sin(ELEM[2]);
        ELEM[2]=Math.atan2(YY,XX);
        if (ELEM[2]<0.0)
        {
            ELEM[2]=ELEM[2]+2.0*Math.PI;
        }
        double xmu=MU[nsat];
        // double xmu = mu_ganymede;
        ELEM2PV(xmu,ELEM,XV);
        ELEM[1]=XV[1]*Math.cos(ome)-XV[2]*Math.sin(ome)*Math.cos(ainc)+XV[3]*Math.sin(ainc)*Math.sin(ome);
        ELEM[2]=XV[1]*Math.sin(ome)+XV[2]*Math.cos(ome)*Math.cos(ainc)-XV[3]*Math.sin(ainc)*Math.cos(ome);
        ELEM[3]=XV[2]*Math.sin(ainc)+XV[3]*Math.cos(ainc);
        ELEM[4]=XV[4]*Math.cos(ome)-XV[5]*Math.sin(ome)*Math.cos(ainc)+XV[6]*Math.sin(ainc)*Math.sin(ome);
        ELEM[5]=XV[4]*Math.sin(ome)+XV[5]*Math.cos(ome)*Math.cos(ainc)-XV[6]*Math.sin(ainc)*Math.cos(ome);
        ELEM[6]=XV[5]*Math.sin(ainc)+XV[6]*Math.cos(ainc);

        // Position in m
        Vector3D position = new Vector3D(ELEM[1]*UA, ELEM[2]*UA, ELEM[3]*UA);

        // Velocity in m/s
        Vector3D velocity = new Vector3D(ELEM[4]*UA/SEC_PER_DAY, ELEM[5]*UA/SEC_PER_DAY, ELEM[6]*UA/SEC_PER_DAY);

        // Position and velocity are computed for J2000 frame
        Vector3D positionInvTrans = EphemerisUtil.inverseTransformJ2000(position);
        Vector3D velocityInvTrans = EphemerisUtil.inverseTransformJ2000(velocity);
        return new Vector3D[]{positionInvTrans,velocityInvTrans};
    }
}
